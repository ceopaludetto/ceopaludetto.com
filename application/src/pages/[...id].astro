---
import type { InferGetStaticPropsType } from "astro";

import { getCollection, render } from "astro:content";
import { formatDate } from "date-fns";

import Base from "~/layouts/base.astro";
import Post from "~/layouts/post.astro";

export async function getStaticPaths() {
	return (await getCollection("posts", ({ data }) => import.meta.env.DEV || !data.draft))
		.map((entry) => ({ params: { id: entry.id }, props: { entry } }));
}

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { entry } = Astro.props;
const { Content } = await render(entry);
---

<Base title={`${entry.data.title} â€” ceo`} color={entry.data.color}>
	<Post>
		<h1 class="mb-1">{entry.data.title}</h1>
		<p class="text-on-surface-variant mt-0 mb-8">{formatDate(entry.data.date, "MMMM d, yyyy")}</p>
		<Content />
	</Post>
</Base>

